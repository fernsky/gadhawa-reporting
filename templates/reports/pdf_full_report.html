{% extends 'reports/pdf_base.html' %}
{% load nepali_filters %}

{% block title %}गढवा गाउँपालिका - पूर्ण प्रतिवेदन{% endblock %}

{% block content %}
<!-- Cover Page -->
<div class="cover-page">
    <div style="text-align: center; margin-bottom: 4cm;">
        <!-- Logo and Header Section -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2cm;">
            <div style="width: 80px; height: 80px;">
                <!-- Nepal Government Logo placeholder -->
            </div>
            <div style="flex-grow: 1;">
                <div style="color: #1e3a8a; font-size: 20pt; font-weight: 700; margin-bottom: 0.5em;">
                    गढवा गाउँपालिका
                </div>
                <div style="color: #1e40af; font-size: 16pt; font-weight: 600; margin-bottom: 0.5em;">
                    गाउँकार्यपालिकाको कार्यालय
                </div>
                <div style="color: #1e40af; font-size: 12pt; margin-bottom: 0.5em;">
                    लुम्बिनी प्रदेश ,नेपाल सरकार
                </div>
            </div>
            <div style="width: 80px; height: 80px;">
                <!-- Municipality Logo placeholder -->
            </div>
        </div>
        
        <!-- Main Title Section -->
        <div style="color: #1e3a8a; padding: 1.5em; margin: 2cm 0; font-size: 24pt; font-weight: 700; ">
            गाउँपालिका पार्श्वचित्र
        </div>

        <!-- Bottom Section -->
        <div style="color: #0f172a; padding: 1em; margin-top: 1cm; ">
            <div style="font-size: 16pt; font-weight: 600;">मस्यौदा प्रतिवेदन</div>
            <div style="font-size: 18pt; font-weight: 700;">२०८१</div>
        </div>
    </div>
    
    <!-- Publication Info (if needed) -->
    {% if publication_settings %}
    <div style="position: absolute; bottom: 2cm; left: 50%; transform: translateX(-50%); text-align: center; font-size: 10pt; color: #64748b;">
        <div>प्रकाशन मिति: {{ publication_settings.publication_date|nepali_date:"Y F j" }}</div>
        {% if publication_settings.version %}
        <div>संस्करण: {{ publication_settings.version }}</div>
        {% endif %}
    </div>
    {% endif %}
</div>

<!-- Table of Contents -->
<div class="toc-page">
    <h1 class="toc-title" style="color: #1e3a8a; border-bottom: 3px solid #0ea5e9;">सूचीपत्र</h1>
    
    <!-- Front Matter -->
    <div class="toc-item level-1">
        <span>सूचीपत्र</span>
        <span class="page-number">i</span>
    </div>
    {% if total_figures > 0 %}
    <div class="toc-item level-1">
        <span>चित्रहरूको सूची</span>
        <span class="page-number">ii</span>
    </div>
    {% endif %}
    {% if total_tables > 0 %}
    <div class="toc-item level-1">
        <span>तालिकाहरूको सूची</span>
        <span class="page-number">iii</span>
    </div>
    {% endif %}
    
    <div style="margin: 1.5em 0; border-bottom: 1px solid #e2e8f0;"></div>
    
    <!-- Main Content -->
    {% for category in categories %}
    <div class="toc-item level-1">
        <span>{{ category.order|default:forloop.counter|nepali_digits }}. {{ category.name_nepali|default:category.name }}</span>
        <span class="page-number">{{ forloop.counter|nepali_digits }}</span>
    </div>
    {% for section in category.sections.all %}
    <div class="toc-item level-2">
        <span>{{ category.order|default:forloop.parentloop.counter|nepali_digits }}.{{ section.order|default:forloop.counter|nepali_digits }} {{ section.title_nepali|default:section.title }}</span>
        <span class="page-number">{{ forloop.parentloop.counter|nepali_digits }}.{{ forloop.counter|nepali_digits }}</span>
    </div>
    {% endfor %}
    {% endfor %}
</div>

<!-- List of Figures -->
{% if figures %}
<div class="list-page">
    <h1 class="list-title" style="color: #1e3a8a; border-bottom: 3px solid #0ea5e9;">चित्रहरूको सूची</h1>
    {% for figure in figures %}
    <div class="list-item">
        <span class="title">चित्र {{ figure.figure_number|nepali_digits }}: {{ figure.title_nepali|default:figure.title }}</span>
        <span class="page-number">{{ forloop.counter|nepali_digits }}</span>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- List of Tables -->
{% if tables %}
<div class="list-page">
    <h1 class="list-title" style="color: #1e3a8a; border-bottom: 3px solid #0ea5e9;">तालिकाहरूको सूची</h1>
    {% for table in tables %}
    <div class="list-item">
        <span class="title">तालिका {{ table.table_number|nepali_digits }}: {{ table.title_nepali|default:table.title }}</span>
        <span class="page-number">{{ forloop.counter|nepali_digits }}</span>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- Main Content -->
{% for category in categories %}
<div class="section-break">
    <h1 class="category-title" style="color: #1e3a8a; background: linear-gradient(90deg, #f1f5f9, #e2e8f0); padding: 0.5em; border-left: 5px solid #0ea5e9;">{{ category.order|default:forloop.counter|nepali_digits }}. {{ category.name_nepali|default:category.name }}</h1>
    
    {% if category.description_nepali or category.description %}
    <div class="lead">{{ category.description_nepali|default:category.description }}</div>
    {% endif %}
    
    {% for section in category.sections.all %}
    <div class="{% if not forloop.first %}no-break{% endif %}" style="margin-top: 2em;">
        <h2 style="color: #1e40af; border-bottom: 2px solid #0ea5e9; padding-bottom: 0.3em;">{{ category.order|default:forloop.parentloop.counter|nepali_digits }}.{{ section.order|default:forloop.counter|nepali_digits }} {{ section.title_nepali|default:section.title }}</h2>
        
        {% if section.summary_nepali or section.summary %}
        <p class="lead">{{ section.summary_nepali|default:section.summary }}</p>
        {% endif %}
        
        {% if section.content_nepali or section.content %}
        <div class="content-section">
            {{ section.content_nepali|default:section.content|safe }}
        </div>
        {% else %}
        <div class="note" style="background: #f0f9ff; border-left: 4px solid #06b6d4; padding: 1em; margin: 1em 0;">
            <p>यस खण्डमा {{ section.title_nepali|default:section.title }} सम्बन्धी विस्तृत जानकारी समावेश गरिनेछ।</p>
            
            <!-- Add contextual sample content -->
            {% if 'demographic' in section.slug or 'जनसंख्या' in section.title_nepali %}
            <div class="table-container">
                <table style="border: 1px solid #cbd5e1;">
                    <caption><strong>जनसंख्या विवरण (नमूना डेटा)</strong></caption>
                    <thead style="background: #1e3a8a; color: white;">
                        <tr>
                            <th style="border: 1px solid #475569;">वडा नं.</th>
                            <th style="border: 1px solid #475569;">पुरुष</th>
                            <th style="border: 1px solid #475569;">महिला</th>
                            <th style="border: 1px solid #475569;">कुल</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #f8fafc;"><td style="border: 1px solid #e2e8f0;">१</td><td style="border: 1px solid #e2e8f0;">१,२५०</td><td style="border: 1px solid #e2e8f0;">१,१८०</td><td style="border: 1px solid #e2e8f0;">२,४३०</td></tr>
                        <tr><td style="border: 1px solid #e2e8f0;">२</td><td style="border: 1px solid #e2e8f0;">१,१००</td><td style="border: 1px solid #e2e8f0;">१,०५०</td><td style="border: 1px solid #e2e8f0;">२,१५०</td></tr>
                        <tr style="background: #f8fafc;"><td style="border: 1px solid #e2e8f0;">३</td><td style="border: 1px solid #e2e8f0;">९८०</td><td style="border: 1px solid #e2e8f0;">९४०</td><td style="border: 1px solid #e2e8f0;">१,९२०</td></tr>
                        <tr style="font-weight: bold; background: #e2e8f0;"><td style="border: 1px solid #cbd5e1;">कुल</td><td style="border: 1px solid #cbd5e1;">३,३३०</td><td style="border: 1px solid #cbd5e1;">३,१७०</td><td style="border: 1px solid #cbd5e1;">६,५००</td></tr>
                    </tbody>
                </table>
            </div>
            {% elif 'economic' in section.slug or 'आर्थिक' in section.title_nepali %}
            <div class="table-container">
                <table style="border: 1px solid #cbd5e1;">
                    <caption><strong>आर्थिक गतिविधि (नमूना डेटा)</strong></caption>
                    <thead style="background: #1e3a8a; color: white;">
                        <tr>
                            <th style="border: 1px solid #475569;">गतिविधि</th>
                            <th style="border: 1px solid #475569;">घरधुरी संख्या</th>
                            <th style="border: 1px solid #475569;">प्रतिशत</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #f8fafc;"><td style="border: 1px solid #e2e8f0;">कृषि</td><td style="border: 1px solid #e2e8f0;">८५०</td><td style="border: 1px solid #e2e8f0;">६५%</td></tr>
                        <tr><td style="border: 1px solid #e2e8f0;">व्यापार</td><td style="border: 1px solid #e2e8f0;">२००</td><td style="border: 1px solid #e2e8f0;">१५%</td></tr>
                        <tr style="background: #f8fafc;"><td style="border: 1px solid #e2e8f0;">सेवा</td><td style="border: 1px solid #e2e8f0;">१५०</td><td style="border: 1px solid #e2e8f0;">१२%</td></tr>
                        <tr><td style="border: 1px solid #e2e8f0;">अन्य</td><td style="border: 1px solid #e2e8f0;">१००</td><td style="border: 1px solid #e2e8f0;">८%</td></tr>
                    </tbody>
                </table>
            </div>
            {% endif %}
        </div>
        {% endif %}
        
        <!-- Section Figures -->
        {% for figure in section.figures.all %}
        <div class="figure-container">
            {% if figure.image %}
            <img src="{{ figure.image.url }}" alt="{{ figure.title_nepali|default:figure.title }}">
            {% endif %}
            <div class="figure-caption">
                <strong>चित्र {{ figure.figure_number|nepali_digits }}:</strong> {{ figure.title_nepali|default:figure.title }}
                {% if figure.description_nepali or figure.description %}
                <br>{{ figure.description_nepali|default:figure.description }}
                {% endif %}
            </div>
        </div>
        {% endfor %}
        
        <!-- Section Tables -->
        {% for table in section.tables.all %}
        <div class="table-container">
            <table style="border: 1px solid #cbd5e1;">
                <caption>
                    <strong>तालिका {{ table.table_number }}:</strong> {{ table.title_nepali|default:table.title }}
                </caption>
                {% if table.data %}
                {{ table.data|safe }}
                {% else %}
                <thead style="background: #1e3a8a; color: white;">
                    <tr>
                        <th style="border: 1px solid #475569;">विवरण</th>
                        <th style="border: 1px solid #475569;">संख्या</th>
                        <th style="border: 1px solid #475569;">प्रतिशत</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="3" style="text-align: center; color: #64748b; font-style: italic; border: 1px solid #e2e8f0;">
                            डेटा उपलब्ध छैन
                        </td>
                    </tr>
                </tbody>
                {% endif %}
            </table>
        </div>
        {% endfor %}
    </div>
    {% endfor %}
</div>
{% endfor %}

<!-- Back Cover / Additional Information -->
<div class="section-break">
    <h1 style="color: #1e3a8a; background: linear-gradient(90deg, #f1f5f9, #e2e8f0); padding: 0.5em; border-left: 5px solid #0ea5e9;">अतिरिक्त जानकारी</h1>
    
    <div class="no-break">
        <h2 style="color: #1e40af; border-bottom: 2px solid #0ea5e9; padding-bottom: 0.3em;">गढवा गाउँपालिकाको सम्पर्क विवरण</h2>
        <div class="important" style="background: #dbeafe; border-left: 4px solid #2563eb; padding: 1em; margin: 1em 0;">
            <p><strong>कार्यपालिकाको कार्यालय:</strong><br>
            गढवा गाउँपालिका<br>
            बाँके, लुम्बिनी प्रदेश, नेपाल</p>
            
            <p><strong>फोन:</strong> ०८१-४०००००<br>
            <strong>इमेल:</strong> info@gadhawa.gov.np<br>
            <strong>वेबसाइट:</strong> www.gadhawa.gov.np</p>
        </div>
    </div>
    
    {% if publication_settings %}
    <div class="no-break mt-3">
        <h2 style="color: #1e40af; border-bottom: 2px solid #0ea5e9; padding-bottom: 0.3em;">प्रकाशन सम्बन्धी जानकारी</h2>
        <div class="note" style="background: #f0f9ff; border-left: 4px solid #06b6d4; padding: 1em; margin: 1em 0;">
            <p><strong>प्रकाशक:</strong> गढवा गाउँपालिका<br>
            <strong>प्रकाशन मिति:</strong> {{ publication_settings.publication_date|date:"Y F j" }}<br>
            <strong>संस्करण:</strong> {{ publication_settings.version }}</p>
            
            {% if publication_settings.isbn %}
            <p><strong>ISBN:</strong> {{ publication_settings.isbn }}</p>
            {% endif %}
            
            {% if publication_settings.editor_name %}
            <p><strong>सम्पादक:</strong> {{ publication_settings.editor_name }}</p>
            {% endif %}
        </div>
    </div>
    {% endif %}
    
    <div class="no-break mt-3">
        <h2 style="color: #1e40af; border-bottom: 2px solid #0ea5e9; padding-bottom: 0.3em;">कानुनी सूचना</h2>
        <div class="warning" style="background: #fef3cd; border-left: 4px solid #f59e0b; padding: 1em; margin: 1em 0;">
            <p>यस प्रतिवेदनमा उल्लेखित सबै तथ्यांक र जानकारीहरू सम्बन्धित निकायबाट प्राप्त भएका हुन्। डेटाको शुद्धताका लागि गढवा गाउँपालिका जिम्मेवार छ।</p>
            
            <p>यस प्रतिवेदनको कुनै पनि भाग गढवा गाउँपालिकाको लिखित अनुमति बिना पुनः प्रकाशन गर्न मिल्दैन।</p>
        </div>
    </div>
    
    <div class="page-footer mt-3">
        <div class="text-center">
            <p style="font-size: 12pt; font-weight: bold;">
                गढवा गाउँपालिका<br>
                "समृद्ध गढवा, सुखी नागरिक"
            </p>
            <p style="font-size: 10pt; color: #64748b;">
                यो प्रतिवेदन {{ generated_date|date:"Y F j" }} मा तयार गरिएको हो。
            </p>
        </div>
    </div>
</div>

{% endblock %}
